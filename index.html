

<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Line Chart</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>

        function Get(yourUrl){
            var Httpreq = new XMLHttpRequest(); // a new request
            Httpreq.open("GET",yourUrl,false);
            Httpreq.send(null);
            return Httpreq.responseText;
        }

        //list of countries interested
        var countries = ['usa', 'sweden', 'italy', 'south-korea'];
        // var countries = ['usa', 'sweden'];
        //Create 2D array, first layer: countries, second: deaths for each countries per day
        var allDeaths = new Array(countries.length);
        for(var i =0; i < allDeaths.length; i++){
            allDeaths[i] = new Array();
        }

        console.log('AllDeaths length: ' + allDeaths.length);

        var requestOptions = {
            method: 'GET',
            redirect: 'follow'
        };
        var baseUrl = 'https://api.covid19api.com';
        var dateStart = '2020-03-15';
        var dateEnd = '2020-07-18';

        for(var a = 0; a < allDeaths.length; a++){
            var country = countries[a];
            var url = baseUrl + "/total/country/" + country + "?from=" + dateStart + "&to=" + dateEnd;
            //Get the json object based on parameters defined above
            var jsonObj = JSON.parse(Get(url));

            var deathArr = new Array();
            for(var i = 0; i < jsonObj.length; i++){
                var obj = jsonObj[i];
                //deathArr.push(obj.Deaths);
                allDeaths[a].push(obj.Deaths);
            }
            //allDeaths[a].push(deathArr);
        }

        var arr1 = countries;
        arr1.unshift('date');

        console.log(allDeaths);




        google.charts.load('current', {
            'packages': ['line']
        });
        google.charts.setOnLoadCallback(drawMyChart);

        function drawMyChart() {
            var arr = ['Day', 'USA', 'Sweden', 'Italy', 'South Korea'];

            var data = new google.visualization.DataTable();
            data.addColumn('number', arr[0]);
            data.addColumn('number', arr[1]);
            data.addColumn('number', arr[2]);
            data.addColumn('number', arr[3]);
            data.addColumn('number', arr[4]);


            //TODO: fix, source array was changed from 1d to 2d
            for(var i = 0; i < allDeaths[0].length; i++){
                data.addRows([
                    //data array has no date, so index starts at 0
                    [i, allDeaths[0][i], allDeaths[1][i], allDeaths[2][i], allDeaths[3][i]]
                ])
            }

            var options = {
                chart: {
                    title: 'Death since ' + dateStart,
                },
                width: 900,
                height: 500
            };

            var chart = new google.charts.Line(document.getElementById('linechart_material'));
            chart.draw(data, google.charts.Line.convertOptions(options));
        }


        // google.charts.load('current', {
        //     'packages': ['line']
        // });
        // google.charts.setOnLoadCallback(drawChart);
        //
        // function drawChart() {
        //
        //     var data = new google.visualization.DataTable();
        //     data.addColumn('number', 'Day');
        //     data.addColumn('number', 'Guardians of the Galaxy');
        //     data.addColumn('number', 'The Avengers');
        //     data.addColumn('number', 'Transformers: Age of Extinction');
        //
        //     data.addRows([
        //         [1, 37.8, 80.8, 41.8],
        //         [2, 30.9, 69.5, 32.4],
        //         [3, 25.4, 57, 25.7],
        //         [4, 11.7, 18.8, 10.5],
        //         [5, 11.9, 17.6, 10.4],
        //         [6, 8.8, 13.6, 7.7],
        //         [7, 7.6, 12.3, 9.6],
        //         [8, 12.3, 29.2, 10.6],
        //         [9, 16.9, 42.9, 14.8],
        //         [10, 12.8, 30.9, 11.6],
        //         [11, 5.3, 7.9, 4.7],
        //         [12, 6.6, 8.4, 5.2],
        //         [13, 4.8, 6.3, 3.6],
        //         [14, 4.2, 6.2, 3.4]
        //     ]);
        //
        //     var options = {
        //         chart: {
        //             title: 'Box Office Earnings in First Two Weeks of Opening',
        //             subtitle: 'in millions of dollars (USD)'
        //         },
        //         width: 900,
        //         height: 500
        //     };
        //
        //     var chart = new google.charts.Line(document.getElementById('linechart_material'));
        //
        //     chart.draw(data, google.charts.Line.convertOptions(options));
        //}
    </script>

</head>

<body>
    <div id="linechart_material"></div>


</body>

</html>